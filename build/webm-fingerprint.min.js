var BitArray=function(t,e){if(this.values=[],e){if(e=e.slice(/^0x/.exec(e)?2:0),4*e.length>this.length)throw"Hex value is too large for this bit array.";if(4*e.length<this.length)for(;4*e.length<this.length;)e="0"+e;for(var r=0;r<e.length/8;r++){var n=e.slice(8*r,8*r+8);this.values[r]=parseInt(n,16)}}else for(var r=0;r<Math.ceil(t/32);r+=1)this.values[r]=0};BitArray.prototype.size=function(){return 32*this.values.length},BitArray.prototype.set=function(t,e){var r=Math.floor(t/32);return e?this.values[r]|=1<<t-32*r:this.values[r]&=~(1<<t-32*r),this},BitArray.prototype.toggle=function(t){var e=Math.floor(t/32);return this.values[e]^=1<<t-32*e,this},BitArray.prototype.get=function(t){var e=Math.floor(t/32);return!!(this.values[e]&1<<t-32*e)},BitArray.prototype.reset=function(){return this.values=[],this},BitArray.prototype.copy=function(){var t=new BitArray;return t.length=this.length,t.values=[].concat(this.values),t},BitArray.prototype.equals=function(t){return this.values.length===t.values.length&&this.values.every(function(e,r){return e===t.values[r]})},BitArray.prototype.toJSON=function(){return JSON.stringify(this.values)},BitArray.prototype.toString=function(){return this.toArray().map(function(t){return t?"1":"0"}).join("")},BitArray.prototype.toBinaryString=function(){return this.toArray().map(function(t){return t?"1":"0"}).reverse().join("")},BitArray.prototype.toHexString=function(){for(var t=[],e=0;e<this.values.length;e+=1)t.push(("00000000"+(this.values[e]>>>0).toString(16)).slice(-8));return t.join("")},BitArray.prototype.toArray=function(){for(var t=[],e=0;e<32*this.values.length;e+=1)t.push(this.get(e));return t},BitArray.prototype.count=function(){var t=0;return this.values.forEach(function(e){e-=e>>1&1431655765,e=(858993459&e)+(e>>2&858993459),e+=e>>4,e&=252645135,t+=16843009*e>>24}),t},BitArray.prototype.not=function(){return this.values=this.values.map(function(t){return~t}),this},BitArray.prototype.or=function(t){if(this.values.length!==t.values.length)throw"Arguments must be of the same length.";return this.values=this.values.map(function(e,r){return e|t.values[r]}),this},BitArray.prototype.and=function(t){if(this.values.length!==t.values.length)throw"Arguments must be of the same length.";return this.values=this.values.map(function(e,r){return e&t.values[r]}),this},BitArray.prototype.xor=function(t){if(this.values.length!==t.values.length)throw"Arguments must be of the same length.";return this.values=this.values.map(function(e,r){return e^t.values[r]}),this};var PerceptualHash=function(){function t(t,e,r,n){void 0===n&&(n=!0);var a=document.createElement("canvas");a.width=e,a.height=r;var i=a.getContext("2d");i.drawImage(t,0,0,e,r);var o=i.getImageData(0,0,e,r).data;if(!n)return o;for(var u=[],s=0;r*e*4>s;s+=4){var h=(o[s]+o[s+1]+o[s+2])/3;h*=255/o[s+3],u.push(Math.floor(h))}return u}function e(e){for(var r=t(e,8,8),n=r.reduce(function(t,e){return t+e}),a=n/r.length,i=new BitArray(64),o=0;64>o;o++)i.set(o,r[o]>=a);return i.toHexString()}function r(e){for(var r=t(e,9,8),n=new BitArray(64),a=0;64>a;a++)n.set(a,r[a]<r[a+1]);return n.toHexString()}function n(e){for(var r=t(e,16,16,!1),n=0,a=0,i=0,o=0;o<r.length-3;o+=3)n+=r[o]||0,a+=r[o-1]||0,i+=r[o-2]||0;for(var u=[Math.floor(n/r.length),Math.floor(a/r.length),Math.floor(i/r.length)],s=0,h={},o=0;o<r.length-3;o+=3){var l=0;l+=Math.abs(r[o]-u[0]),l+=Math.abs(r[o+1]-u[1]),l+=Math.abs(r[o+2]-u[2]),s+=l;var v=r[o]+","+r[o+1]+","+r[o+2];h[v]=!0}var f=Object.keys(h).length;return f+s}return{aHash:e,dHash:r,cHash:n,createImage:t}}(),WebMFingerprint=function(){function t(t,e,r){function n(){if(!l)return a();if(v.length>=24||t.currentTime==t.duration){l=!1;var e=v.indexOf(v.concat().sort().reverse()[0]);return t.currentTime=Math.floor(t.currentTime)-1+e*h,void(v=[])}v.push(PerceptualHash.cHash(t)),t.currentTime+=h}function a(){if(i){var e=PerceptualHash.aHash(t);-1==s.indexOf(e)&&s.push(e)}if(o){var e=PerceptualHash.dHash(t);-1==u.indexOf(e)&&u.push(e)}return t.duration-t.currentTime>1?void(t.currentTime=Math.floor(t.currentTime)+1):(t.removeEventListener("seeked",n),r(null,{aHashes:s,dHashes:u}))}var i=!0,o=!0;e.aHash===!1&&(i=!1),e.dHash===!1&&(o=!1),t.currentTime=0;var u=[],s=[],h=1/24,l=!0,v=[];t.addEventListener("seeked",n),n()}function e(e,r){var n={};if(void 0==e.nodeName){var n=e;if(e=n.element,!n.element)return r("No element specified.")}var a=e.duration;return 1/0==a?r("Cannot fingerprint streaming media."):void 0==a||0/0==a?r("Video length not available."):0==a||0==e.readyState?e.addEventListener("loadedmetadata",function(){t(e,n,r)}):void t(e,n,r)}return e}();"undefined"!=typeof module&&module.exports&&(module.exports=WebMFingerprint);
//# sourceMappingURL=webm-fingerprint.min.js.map